<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HanoiStay | Trạm kết nối không gian sống</title>
    <meta name="description" content="Trạm kết nối không gian sống đẳng cấp">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,600;0,700;1,400&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <style>
        /* ==========================================================================
           2. HỆ THỐNG DESIGN SYSTEM (ROYAL DARK THEME)
           ========================================================================== */
        :root {
            /* Palette: Gold & Dark */
            --gold-primary: #D4AF37;       /* Vàng Kim Loại */
            --gold-hover: #F1C40F;
            --gold-dim: rgba(212, 175, 55, 0.1);
            --gold-gradient: linear-gradient(135deg, #D4AF37 0%, #F6E27A 50%, #D4AF37 100%);

            --black-bg: #0A0A0A;           /* Nền chính siêu tối */
            --black-card: #141414;         /* Nền Card */
            --black-surface: #1F1F1F;      /* Nền Input/Button */
            
            --text-main: #FFFFFF;          /* Chữ trắng */
            --text-sub: #A3A3A3;           /* Chữ xám bạc */
            --text-muted: #525252;
            
            --border: #333333;             /* Viền xám tối */
            --border-gold: 1px solid var(--gold-primary);

            /* Functional */
            --success: #10B981;
            --danger: #EF4444;

            /* Metrics */
            --header-h: 90px;
            --container: 1280px;
            --radius: 4px; /* Bo góc vuông vức nam tính */

            /* Effects */
            --shadow-gold: 0 0 25px rgba(212, 175, 55, 0.15);
            --shadow-card: 0 20px 50px rgba(0,0,0,0.7);
            --transition: all 0.3s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        /* RESET */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Manrope', sans-serif; scroll-behavior: smooth; }
        body { background-color: var(--black-bg); color: var(--text-main); line-height: 1.6; padding-top: var(--header-h); overflow-x: hidden; }
        
        h1, h2, h3, h4, h5 { font-family: 'Playfair Display', serif; color: var(--gold-primary); margin-bottom: 1rem; letter-spacing: 0.5px; }
        a { text-decoration: none; color: inherit; transition: var(--transition); cursor: pointer; }
        button { border: none; outline: none; background: none; cursor: pointer; transition: var(--transition); font-family: inherit; }
        ul { list-style: none; }
        img { max-width: 100%; display: block; }
        .container { max-width: var(--container); margin: 0 auto; padding: 0 24px; }
        .hidden { display: none !important; }
        
        /* Utility */
        .text-gold { color: var(--gold-primary) !important; }
        .text-white { color: white !important; }
        .text-center { text-align: center; }

        /* =========================================
           3. UI COMPONENTS
           ========================================= */
        /* Buttons */
        .btn { display: inline-flex; align-items: center; justify-content: center; padding: 14px 32px; font-weight: 700; font-size: 13px; text-transform: uppercase; letter-spacing: 2px; border: 1px solid var(--gold-primary); color: var(--gold-primary); position: relative; overflow: hidden; z-index: 1; transition: var(--transition); }
        .btn::after { content:''; position: absolute; top:0; left:0; width:0; height:100%; background: var(--gold-primary); z-index: -1; transition: var(--transition); }
        .btn:hover { color: black; box-shadow: var(--shadow-gold); }
        .btn:hover::after { width: 100%; }
        
        .btn-filled { background: var(--gold-primary); color: black; }
        .btn-filled:hover { background: white; border-color: white; }

        .btn-full { width: 100%; }

        /* Inputs */
        .form-control { width: 100%; padding: 15px; background: var(--black-surface); border: 1px solid var(--border); color: white; font-size: 15px; outline: none; transition: 0.3s; }
        .form-control:focus { border-color: var(--gold-primary); box-shadow: 0 0 15px var(--gold-dim); }

        /* Cards */
        .card { background: var(--black-card); border: 1px solid var(--border); transition: var(--transition); position: relative; overflow: hidden; }
        .card:hover { transform: translateY(-10px); border-color: var(--gold-primary); box-shadow: var(--shadow-gold); }

        /* Badges */
        .badge { padding: 4px 10px; font-size: 10px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; display: inline-block; border: 1px solid var(--gold-primary); color: var(--gold-primary); }

        /* View Animation */
        .view-section { display: none; animation: fadeIn 0.8s ease; padding-bottom: 80px; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }

        /* =========================================
           4. HEADER
           ========================================= */
        header { position: fixed; top: 0; left: 0; width: 100%; height: var(--header-h); background: rgba(10, 10, 10, 0.9); backdrop-filter: blur(20px); z-index: 1000; border-bottom: 1px solid rgba(212, 175, 55, 0.2); }
        .nav-inner { height: 100%; display: flex; justify-content: space-between; align-items: center; }
        
        /* LOGO SVG VÀNG */
        .logo { display: flex; align-items: center; gap: 15px; cursor: pointer; }
        .logo svg { width: 50px; height: 50px; fill: none; stroke: var(--gold-primary); stroke-width: 2; filter: drop-shadow(0 0 5px var(--gold-primary)); }
        .logo-text h1 { font-size: 24px; margin: 0; line-height: 1; color: white; letter-spacing: 1px; }
        .logo-text p { font-size: 9px; font-weight: 700; color: var(--gold-primary); text-transform: uppercase; letter-spacing: 3px; margin: 5px 0 0 0; }

        .nav-menu { display: flex; gap: 40px; }
        .nav-link { font-weight: 600; color: var(--text-sub); font-size: 12px; position: relative; padding: 10px 0; text-transform: uppercase; letter-spacing: 2px; transition: 0.3s; }
        .nav-link:hover, .nav-link.active { color: var(--gold-primary); text-shadow: 0 0 10px var(--gold-primary); }
        .nav-link.active::after { content:''; position: absolute; bottom:0; left:0; width:100%; height:1px; background: var(--gold-primary); box-shadow: 0 0 10px var(--gold-primary); }

        .auth-actions { display: flex; gap: 15px; align-items: center; }

        /* =========================================
           5. VIEW 1: KHÁM PHÁ (HOME & SEARCH)
           ========================================= */
        .hero { 
            position: relative; height: 850px; display: flex; align-items: center; justify-content: center; text-align: center;
            background: radial-gradient(circle at center, rgba(0,0,0,0.2) 0%, rgba(10,10,10,1) 90%), url('https://images.unsplash.com/photo-1618221195710-dd6b41faaea6?w=1600') center/cover fixed;
            margin-bottom: -150px;
        }
        .hero-content { z-index: 2; width: 100%; max-width: 1000px; padding: 0 20px; margin-bottom: 200px; }
        .hero h1 { font-size: 64px; margin-bottom: 20px; color: var(--gold-primary); text-shadow: 0 0 30px rgba(212, 175, 55, 0.3); }
        .hero-slogan { font-size: 20px; font-family: 'Playfair Display'; font-style: italic; color: white; letter-spacing: 2px; border-top: 1px solid var(--gold-primary); border-bottom: 1px solid var(--gold-primary); padding: 10px 40px; display: inline-block; }

        /* --- SEARCH UI (DARK VERSION OF YOUR IMAGE) --- */
        .search-container { position: absolute; bottom: 220px; width: 50%; padding: 0 20px; z-index: 10; }
        .search-card { 
            background: rgba(20, 20, 20, 0.95); backdrop-filter: blur(30px);
            border: 1px solid var(--gold-primary); border-radius: 4px;
            padding: 40px; max-width: 900px; margin: 0 auto; 
            box-shadow: 0 30px 100px rgba(0,0,0,0.8);
        }
        .search-header { text-align: center; font-weight: 700; font-size: 20px; color: var(--gold-primary); text-transform: uppercase; margin-bottom: 30px; letter-spacing: 3px; border-bottom: 1px solid var(--border); padding-bottom: 15px; }

        /* Dropdowns */
        .search-row-1 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 30px; }
        .select-group { position: relative; }
        .select-label { position: absolute; top: -10px; left: 15px; background: var(--gold-primary); color: black; padding: 2px 8px; font-size: 10px; font-weight: 800; text-transform: uppercase; z-index: 2; }
        .custom-select { width: 100%; padding: 15px 20px; border: 1px solid var(--border); background: var(--black-surface); color: white; font-size: 15px; cursor: pointer; outline: none; transition: 0.3s; }
        .custom-select:hover { border-color: var(--gold-primary); }

        /* Price Buttons (Grid) */
        .label-group { font-size: 12px; color: var(--gold-primary); font-weight: 700; margin-bottom: 12px; display: block; text-transform: uppercase; letter-spacing: 1px; }
        .price-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 30px; }
        .price-btn { 
            padding: 12px; border: 1px solid var(--border); text-align: center; font-size: 13px; 
            color: var(--text-sub); cursor: pointer; transition: 0.3s; background: transparent;
        }
        .price-btn:hover, .price-btn.active { border-color: var(--gold-primary); color: var(--gold-primary); background: var(--gold-dim); box-shadow: 0 0 10px var(--gold-dim); }

        /* Amenity Tags */
        .amenity-tags { display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 30px; }
        .am-tag { 
            padding: 8px 20px; border: 1px solid var(--border); border-radius: 20px; font-size: 12px; 
            color: var(--text-sub); cursor: pointer; transition: 0.3s;
        }
        .am-tag:hover, .am-tag.active { border-color: var(--gold-primary); background: var(--gold-primary); color: black; font-weight: 700; }

        .btn-search-main { width: 100%; background: var(--gold-primary); color: black; padding: 16px; font-size: 16px; font-weight: 800; border: none; transition: 0.3s; cursor: pointer; text-transform: uppercase; letter-spacing: 2px; }
        .btn-search-main:hover { background: white; box-shadow: 0 0 30px white; }

        /* LISTING */
        .listing-container { padding-top: 280px; padding-bottom: 100px; }
        .section-head { display: flex; justify-content: space-between; align-items: end; margin-bottom: 50px; border-bottom: 1px solid var(--border); padding-bottom: 20px; }
        .section-title { font-size: 40px; margin: 0; color: white; }
        
        .room-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 40px; }
        
        /* Room Card */
        .room-img-wrap { height: 260px; position: relative; overflow: hidden; }
        .room-img { width: 100%; height: 100%; object-fit: cover; transition: 0.6s ease; filter: brightness(0.8); }
        .card:hover .room-img { transform: scale(1.1); filter: brightness(1); }
        .room-status { position: absolute; bottom: 0; left: 0; width: 100%; background: rgba(212, 175, 55, 0.9); color: black; text-align: center; padding: 8px; font-size: 12px; font-weight: 800; text-transform: uppercase; letter-spacing: 1px; }
        
        .room-body { padding: 25px; }
        .room-title { font-size: 18px; font-weight: 400; margin-bottom: 10px; color: white; line-height: 1.4; height: 50px; overflow: hidden; font-family: 'Playfair Display'; }
        .room-price { font-size: 22px; font-weight: 700; color: var(--gold-primary); margin-bottom: 15px; display: block; }
        .room-addr { font-size: 13px; color: var(--text-sub); display: flex; gap: 8px; margin-bottom: 20px; align-items: center; }
        .room-addr i { color: var(--gold-primary); }
        
        .room-specs { display: flex; justify-content: space-between; border-top: 1px solid var(--border); padding-top: 15px; font-size: 13px; color: var(--gold-primary); text-transform: uppercase; }

        /* =========================================
           6. VIEW 2: BẢN ĐỒ (DARK MAP SCANNER)
           ========================================= */
        .map-section { height: 750px; display: grid; grid-template-columns: 380px 1fr; background: var(--black-card); border: 1px solid var(--gold-primary); margin-top: 60px; }
        .map-sidebar { padding: 30px; overflow-y: auto; border-right: 1px solid var(--border); background: var(--black-card); }
        .map-head { font-size: 20px; color: var(--gold-primary); margin-bottom: 30px; font-weight: 700; display: flex; align-items: center; gap: 10px; letter-spacing: 2px; }
        
        .radius-control { background: var(--black-surface); padding: 25px; border-radius: 8px; margin-bottom: 30px; border: 1px solid var(--border); }
        .range-slider { width: 100%; accent-color: var(--gold-primary); height: 4px; margin: 20px 0; cursor: pointer; }
        
        .map-result { display: flex; gap: 15px; padding: 15px; border: 1px solid var(--border); margin-bottom: 15px; cursor: pointer; transition: 0.2s; background: rgba(255,255,255,0.02); }
        .map-result:hover { border-color: var(--gold-primary); background: rgba(212, 175, 55, 0.1); }
        .map-thumb { width: 70px; height: 70px; object-fit: cover; border: 1px solid var(--border); }
        
        /* Dark Map Invert */
        #scanMap { width: 100%; height: 100%; z-index: 1; filter: grayscale(100%) invert(100%) contrast(85%); }

        /* =========================================
           7. VIEW 3: GIỚI THIỆU (ABOUT)
           ========================================= */
        .about-hero { padding: 100px 0; background: var(--black-surface); border: 1px solid var(--gold-primary); margin: 60px 0; text-align: center; }
        .mission-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 80px; align-items: center; margin-top: 60px; }
        .ms-card { padding: 40px; border-left: 4px solid var(--gold-primary); background: rgba(255,255,255,0.03); }
        .ms-card h3 { font-size: 24px; margin-bottom: 20px; color: var(--gold-primary); }
        .ms-card p { font-size: 16px; color: var(--text-sub); line-height: 1.8; text-align: justify; }

        /* =========================================
           8. VIEW 4: TIN TỨC (MAGAZINE)
           ========================================= */
        .news-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 40px; margin-top: 50px; }
        .news-main { position: relative; height: 500px; overflow: hidden; cursor: pointer; border: 1px solid var(--border); }
        .news-main img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; opacity: 0.7; }
        .news-main:hover img { transform: scale(1.05); opacity: 1; }
        .news-overlay { position: absolute; bottom: 0; left: 0; padding: 40px; background: linear-gradient(to top, black, transparent); width: 100%; }
        
        .news-side-item { display: flex; gap: 20px; margin-bottom: 20px; padding-bottom: 20px; border-bottom: 1px solid var(--border); cursor: pointer; }
        .news-side-img { width: 100px; height: 80px; object-fit: cover; border: 1px solid var(--border); }
        .news-side-info h4 { font-size: 16px; color: white; margin-bottom: 5px; font-family: 'Manrope'; }
        .news-side-info span { font-size: 12px; color: var(--gold-primary); text-transform: uppercase; }

        /* =========================================
           9. VIEW 5: HỖ TRỢ (SUPPORT)
           ========================================= */
        .support-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 60px; margin-top: 60px; }
        .faq-item { border: 1px solid var(--border); padding: 20px; margin-bottom: 15px; cursor: pointer; transition: 0.3s; background: var(--black-surface); }
        .faq-item:hover { border-color: var(--gold-primary); }
        .faq-q { display: flex; justify-content: space-between; color: white; font-weight: 700; }
        .faq-a { padding-top: 15px; color: var(--text-sub); display: none; font-size: 14px; border-top: 1px solid var(--border); margin-top: 15px; }
        .faq-item.active .faq-a { display: block; }
        .faq-item.active .faq-q { color: var(--gold-primary); }

        /* =========================================
           10. MODAL DETAIL (REPLICA P.002)
           ========================================= */
        .modal-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.95); z-index: 2000; display: none; justify-content: center; align-items: center; }
        .modal-overlay.open { display: flex; animation: fadeIn 0.3s; }
        .modal-content { background: var(--black-card); width: 95%; max-width: 600px; height: 100%; overflow-y: auto; display: block; padding: 0; position: relative; border: 1px solid var(--gold-primary); }

        /* Header Detail Gold */
        .detail-header-bar { background: var(--gold-primary); color: black; padding: 15px; text-align: center; font-weight: 800; font-size: 18px; position: sticky; top: 0; z-index: 10; display: flex; justify-content: center; align-items: center; letter-spacing: 1px; }
        .detail-back { position: absolute; left: 15px; cursor: pointer; font-size: 20px; }

        .d-img { width: 100%; height: 350px; object-fit: cover; border-bottom: 2px solid var(--gold-primary); }
        .d-body { padding: 20px; padding-bottom: 100px; }
        
        .d-title { font-size: 20px; font-weight: 700; margin-bottom: 10px; color: white; line-height: 1.4; font-family: 'Playfair Display'; }
        .d-price { font-size: 24px; color: var(--gold-primary); font-weight: 700; margin-bottom: 10px; }
        .d-addr { color: var(--text-sub); font-size: 13px; margin-bottom: 20px; }

        /* Cost Table (Grid 4 col - Dark) */
        .cost-table { display: grid; grid-template-columns: repeat(4, 1fr); border: 1px solid var(--border); text-align: center; margin: 25px 0; font-size: 12px; background: var(--black-surface); }
        .cost-cell { padding: 15px 5px; border-right: 1px solid var(--border); border-bottom: 1px solid var(--border); color: #ccc; }
        .cost-val { color: var(--gold-primary); font-weight: 800; font-size: 15px; display: block; margin: 5px 0; }
        
        /* Check List */
        .check-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin: 25px 0; font-size: 13px; color: #ccc; }
        .check-item { display: flex; align-items: center; gap: 8px; }
        .fa-check { color: var(--success); }
        .fa-times { color: var(--danger); }

        /* Sticky Footer */
        .detail-footer { position: fixed; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; max-width: 600px; background: var(--black-surface); padding: 15px; border-top: 1px solid var(--border); display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 15px; z-index: 20; }
        .action-icon { display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 11px; color: #888; cursor: pointer; transition: 0.3s; }
        .action-icon:hover { color: var(--gold-primary); }
        .action-icon i { font-size: 22px; margin-bottom: 4px; color: var(--gold-primary); }

        /* =========================================
           11. CHATBOT & AUTH
           ========================================= */
        /* Auth */
        .auth-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.9); z-index: 3000; display: none; justify-content: center; align-items: center; }
        .auth-box { width: 400px; background: var(--black-card); border: 1px solid var(--gold-primary); padding: 40px; text-align: center; position: relative; }
        
        /* Chatbot */
        .chat-btn { position: fixed; bottom: 30px; right: 30px; width: 65px; height: 65px; background: var(--gold-primary); color: black; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 28px; cursor: pointer; z-index: 9000; box-shadow: 0 0 30px rgba(212, 175, 55, 0.4); animation: pulse 2s infinite; }
        .chat-window { position: fixed; bottom: 110px; right: 30px; width: 350px; height: 500px; background: var(--black-card); border: 1px solid var(--gold-primary); z-index: 9000; display: none; flex-direction: column; box-shadow: 0 20px 60px rgba(0,0,0,0.5); }
        .chat-header { background: var(--gold-primary); color: black; padding: 15px; display: flex; justify-content: space-between; align-items: center; font-weight: 800; letter-spacing: 1px; }
        .chat-body { flex: 1; padding: 15px; overflow-y: auto; background: #0f0f0f; }
        .msg { padding: 10px 14px; margin-bottom: 10px; font-size: 13px; max-width: 80%; border-radius: 8px; }
        .bot { background: var(--black-surface); color: white; border: 1px solid var(--border); align-self: flex-start; }
        .user { background: var(--gold-primary); color: black; align-self: flex-end; }
        .chat-footer { padding: 15px; border-top: 1px solid var(--border); display: flex; background: var(--black-card); }
        .chat-input { flex: 1; background: transparent; border: none; color: white; outline: none; }
        
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(212, 175, 55, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(212, 175, 55, 0); } 100% { box-shadow: 0 0 0 0 rgba(212, 175, 55, 0); } }

        /* Footer */
        footer { background: black; color: #666; padding: 80px 0 30px; margin-top: 100px; border-top: 1px solid var(--border); }
        .footer-grid { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 40px; }
        .footer-link:hover { color: var(--gold-primary); padding-left: 5px; }

        @media (max-width: 1024px) {
            .search-row-1 { grid-template-columns: 1fr; }
            .map-section { grid-template-columns: 1fr; height: auto; }
            #scanMap { height: 400px; }
            .news-grid, .support-grid, .footer-grid, .about-grid { grid-template-columns: 1fr; }
            .nav-menu { display: none; }
        }
    </style>
</head>
<body>

    <header>
        <div class="container nav-inner">
            <div class="logo" onclick="app.nav('home')">
                <svg width="45" height="45" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M50 10L10 40V90H90V40L50 10Z" stroke="#D4AF37" stroke-width="3" stroke-linejoin="round"/>
                    <path d="M50 35L30 55C30 55 40 75 50 75C60 75 70 55 70 55L50 35Z" stroke="#D4AF37" stroke-width="3"/>
                    <rect x="42" y="48" width="16" height="16" rx="2" stroke="#D4AF37" stroke-width="2"/>
                </svg>
                <div style="margin-left:12px;">
                    <h1 style="font-size:22px; margin:0; line-height:1; color:white;">HANOISTAY</h1>
                    <p style="font-size:9px; font-weight:700; color:var(--gold-primary); letter-spacing:2px; margin:0;">Trạm kết nối không gian sống</p>
                </div>
            </div>
            
            <ul class="nav-menu">
                <li><a onclick="app.nav('home')" class="nav-link active" id="l-home">Khám Phá</a></li>
                <li><a onclick="app.nav('map')" class="nav-link" id="l-map">Bản Đồ</a></li>
                <li><a onclick="app.nav('news')" class="nav-link" id="l-news">Tin Tức</a></li>
                <li><a onclick="app.nav('support')" class="nav-link" id="l-support">Hỗ Trợ</a></li>
                <li><a onclick="app.nav('about')" class="nav-link" id="l-about">Giới Thiệu</a></li>
            </ul>
            
            <div class="auth-actions">
                <button class="btn btn-outline" onclick="Auth.open('login')">ĐĂNG NHẬP</button>
                <button class="btn btn-filled" onclick="Auth.open('register')">ĐĂNG KÝ</button>
            </div>
        </div>
    </header>

    <main id="view-home" class="view-section active" style="padding-top:0;">
        <section class="hero">
            <div class="hero-content">
                <h1 style="font-size:68px; margin-bottom:15px; color:var(--gold-primary); text-shadow:0 0 30px rgba(212,175,55,0.4);">HANOISTAY</h1>
                <p class="hero-slogan">Trạm kết nối không gian sống</p>
                
                <div class="search-container">
                    <div class="search-card">
                        <div class="search-header">LỌC TÌM PHÒNG</div>
                        
                        <div class="search-row-1">
                            <div class="select-group"><span class="select-label">Tỉnh/Thành phố</span><select class="custom-select"><option>Thành phố Hà Nội</option></select></div>
                            <div class="select-group"><span class="select-label">Quận/Huyện</span><select id="sDist" class="custom-select"><option value="all">Tất cả quận</option><option value="Cầu Giấy">Cầu Giấy</option><option value="Đống Đa">Đống Đa</option><option value="Thanh Xuân">Thanh Xuân</option></select></div>
                            <div class="select-group"><span class="select-label">Loại phòng</span><select id="sType" class="custom-select"><option value="all">Tất cả loại</option><option value="Tro">Phòng trọ</option><option value="Mini">Chung cư Mini</option><option value="Studio">Studio</option></select></div>
                        </div>

                        <div style="margin-bottom:25px;">
                            <label class="label-group">GIÁ <span style="color:var(--danger); font-size:11px;">(CHỌN KHOẢNG)</span></label>
                            <div class="price-grid">
                                <button class="price-btn active" onclick="app.setPrice('all', this)">Tất cả</button>
                                <button class="price-btn" onclick="app.setPrice('low', this)">< 3M</button>
                                <button class="price-btn" onclick="app.setPrice('mid', this)">3 - 5M</button>
                                <button class="price-btn" onclick="app.setPrice('high', this)">5 - 8M</button>
                                <button class="price-btn" onclick="app.setPrice('vip', this)">8 - 12M</button>
                                <button class="price-btn" onclick="app.setPrice('max', this)">> 12M</button>
                            </div>
                        </div>

                        <div style="margin-bottom:30px;">
                            <label class="label-group">TIỆN ÍCH <span style="color:var(--danger); font-size:11px;">(CHỌN THÊM)</span></label>
                            <div class="amenity-tags">
                                <div class="am-tag" onclick="this.classList.toggle('active')">Có máy lạnh</div>
                                <div class="am-tag" onclick="this.classList.toggle('active')">Có gác</div>
                                <div class="am-tag" onclick="this.classList.toggle('active')">Có tủ lạnh</div>
                                <div class="am-tag" onclick="this.classList.toggle('active')">An ninh</div>
                            </div>
                        </div>

                        <button class="btn btn-filled btn-full" style="height:50px; font-size:16px;" onclick="app.search()">TÌM KIẾM NGAY</button>
                    </div>
                </div>
            </div>
        </section>

        <section class="container listing-section">
            <div class="section-head">
                <h2 class="section-title">PHÒNG NỔI BẬT</h2>
                <button class="btn btn-outline" onclick="app.nav('map')">XEM BẢN ĐỒ</button>
            </div>
            
            <div class="room-grid" id="roomGrid"></div>
            <div id="emptyState" class="hidden text-center" style="padding:100px; color:#666;">Không tìm thấy phòng phù hợp.</div>
        </section>
    </main>

    <main id="view-map" class="view-section container" style="margin-top:60px;">
        <h2 class="text-gold" style="font-size:36px; margin-bottom:30px;">QUÉT BẢN ĐỒ</h2>
        <div class="map-section">
            <div class="map-sidebar">
                <div class="map-head"><i class="fas fa-radar"></i> TÌM QUANH ĐÂY</div>
                <div class="radius-control">
                    <div style="display:flex; justify-content:space-between; color:var(--text-sub); font-size:12px; margin-bottom:10px;">
                        <span>BÁN KÍNH</span> <span id="radiusVal" class="text-gold">2 KM</span>
                    </div>
                    <input type="range" id="radiusRange" min="1" max="10" value="2" step="0.5" class="range-slider">
                    <button class="btn btn-filled btn-full" style="margin-top:20px;" onclick="app.scanMap()">KÍCH HOẠT QUÉT</button>
                </div>
                <div id="mapResults" style="margin-top:30px;"></div>
            </div>
            <div id="scanMap"></div>
        </div>
    </main>

    <main id="view-news" class="view-section container" style="margin-top:60px;">
        <h2 style="font-size:36px; color:var(--gold-primary); margin-bottom:40px;">CẨM NANG & TIN TỨC</h2>
        <div class="news-grid" style="display:grid; grid-template-columns:1.8fr 1fr; gap:40px;">
            <div class="news-main" onclick="alert('Đọc tin...')">
                <img src="https://images.unsplash.com/photo-1507089947368-19c1da9775ae?w=1200" alt="News">
                <div class="news-overlay">
                    <span style="color:var(--gold-primary); font-weight:700; font-size:12px; letter-spacing:1px;">NỔI BẬT</span>
                    <h3 style="font-size:28px; margin-top:10px;">5 Kinh nghiệm xương máu khi tìm thuê phòng trọ tại Hà Nội</h3>
                </div>
            </div>
            <div id="newsList"></div>
        </div>
    </main>

    <main id="view-support" class="view-section container" style="margin-top:60px;">
        <div class="support-grid">
            <div>
                <h2 style="color:var(--gold-primary); margin-bottom:30px;">CÂU HỎI THƯỜNG GẶP</h2>
                <div class="faq-item" onclick="this.classList.toggle('active')">
                    <div class="faq-q">Quy định đăng tin? <i class="fas fa-plus text-gold"></i></div>
                    <div class="faq-a">Thông tin phải chính xác 100% và hình ảnh thực tế.</div>
                </div>
                <div class="faq-item" onclick="this.classList.toggle('active')">
                    <div class="faq-q">Phí dịch vụ môi giới? <i class="fas fa-plus text-gold"></i></div>
                    <div class="faq-a">Hoàn toàn miễn phí cho người tìm thuê.</div>
                </div>
            </div>
            <div style="background:var(--black-card); padding:40px; border:1px solid var(--border);">
                <h3 style="color:white; margin-bottom:20px;">GỬI YÊU CẦU</h3>
                <input class="form-control" placeholder="Email của bạn..." style="margin-bottom:15px;">
                <textarea class="form-control" rows="4" placeholder="Nội dung cần hỗ trợ..."></textarea>
                <button class="btn btn-filled btn-full" style="margin-top:20px;">GỬI NGAY</button>
            </div>
        </div>
    </main>

    <main id="view-about" class="view-section container" style="margin-top:60px;">
        <div class="about-hero">
            <span class="badge badge-verified" style="background:rgba(212,175,55,0.1); color:var(--gold-primary); border:1px solid var(--gold-primary);">THƯƠNG HIỆU</span>
            <h1 style="font-size:48px; margin:20px 0;">Sứ mệnh & Tầm nhìn</h1>
            <p style="color:var(--text-sub); max-width:800px; margin:0 auto;">Kiến tạo chuẩn mực sống mới cho người Việt trẻ.</p>
        </div>
        <div class="mission-grid">
            <div class="ms-card">
                <h3>SỨ MỆNH</h3>
                <p>Mang lại sự minh bạch, an toàn và tiện nghi trong từng không gian sống.</p>
            </div>
            <div class="ms-card" style="border-left-color:white;">
                <h3 style="color:white;">TẦM NHÌN</h3>
                <p>Trở thành hệ sinh thái PropTech số 1 Đông Nam Á vào năm 2030.</p>
            </div>
        </div>
    </main>

    <div class="modal-overlay" id="detailModal">
        <div class="modal-content">
            <div class="detail-header-bar">
                <span onclick="app.closeModal()" class="detail-back"><i class="fas fa-arrow-left"></i></span>
                <span id="dCode">Phòng</span>
            </div>
            
            <div class="d-body">
                <img id="dImg" class="d-img">
                <h1 id="dTitle" class="d-title"></h1>
                <p id="dPrice" class="d-price"></p>
                <p class="d-addr"><i class="fas fa-map-marker-alt text-gold"></i> <span id="dAddr"></span></p>

                <div class="cost-table">
                    <div class="cost-cell">Điện<br><span id="cElec" class="cost-val"></span></div>
                    <div class="cost-cell">Nước<br><span id="cWater" class="cost-val"></span></div>
                    <div class="cost-cell">Xe<br><span id="cBike" class="cost-val"></span></div>
                    <div class="cost-cell">Dịch vụ<br><span id="cService" class="cost-val"></span></div>
                </div>

                <div id="amenityList" class="am-list"></div>

                <h3 style="color:var(--gold-primary); font-size:16px; margin-top:30px;">Vị trí</h3>
                <iframe id="dMap" class="map-embed" loading="lazy"></iframe>
            </div>

            <div class="detail-footer">
                <button class="btn btn-filled btn-full">ĐẶT LỊCH XEM</button>
                <div class="act-icon"><i class="far fa-comment-dots"></i> Chat</div>
                <div class="act-icon" onclick="app.callHost()"><i class="fas fa-phone-alt"></i> Gọi</div>
            </div>
        </div>
    </div>

    <div class="modal-overlay" id="authModal">
        <div class="auth-box">
            <button onclick="document.getElementById('authModal').style.display='none'" style="position:absolute; top:20px; right:20px; color:white; font-size:24px;">×</button>
            <h2 style="color:var(--gold-primary); margin-bottom:30px;">ĐĂNG NHẬP</h2>
            <input class="form-control" placeholder="Email" style="margin-bottom:15px;">
            <input class="form-control" type="password" placeholder="Mật khẩu" style="margin-bottom:25px;">
            <button class="btn btn-filled btn-full">TIẾP TỤC</button>
        </div>
    </div>

    <div class="chat-btn" onclick="chatbot.toggle()"><i class="fas fa-comment-dots"></i></div>
    <div class="chat-window" id="chatWindow">
        <div class="chat-header"><span>HỖ TRỢ TRỰC TUYẾN</span><span onclick="chatbot.toggle()" style="cursor:pointer">×</span></div>
        <div id="chatBody" class="chat-body"><div class="msg bot">Chào bạn! Tôi có thể giúp gì?</div></div>
        <div class="chat-footer"><input id="chatInput" class="chat-input" placeholder="Nhập tin..."><button onclick="chatbot.send()" class="text-gold"><i class="fas fa-paper-plane"></i></button></div>
    </div>

    <footer>
        <div class="container footer-grid">
            <div><h2 style="color:var(--gold-primary); margin-bottom:20px;">HANOISTAY</h2><p style="font-size:13px; color:#666;">Trạm kết nối không gian sống<br>Phòng H301, Trường Đại Học Ngoại Thương</p></div>
            <div><h4 style="color:white; margin-bottom:20px;">KHÁM PHÁ</h4><ul style="color:#666; font-size:14px;"><li>Lọc Tìm Phòng</li><li>Phòng Trọ</li></ul></div>
            <div><h4 style="color:white; margin-bottom:20px;">HỖ TRỢ</h4><ul style="color:#666; font-size:14px;"><li>Bảng giá</li><li>Quy định</li></ul></div>
            <div><h4 style="color:white; margin-bottom:20px;">LIÊN HỆ</h4><ul style="color:#666; font-size:14px;"><li>1900 8888</li><li>nhom4@hanoistay.vn</li></ul></div>
        </div>
    </footer>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // --- DATABASE ---
        const rooms = [
            {
                id: 1, title: "Studio Cầu Giấy View Hồ", price: 5.5, district: "Cầu Giấy", type: "Studio", area: 35, 
                lat: 21.0350, lng: 105.7950, address: "Quan Hoa, Cầu Giấy", img: "https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=800", host: {phone: "0912345678"},
                costs: { elec: "3.8k", water: "100k", bike: "Free", service: "150k" },
                amenities: ["Máy lạnh", "Tủ lạnh", "Gác", "Wifi"]
            },
            {
                id: 2, title: "Chung cư Mini Đống Đa", price: 4.0, district: "Đống Đa", type: "Mini", area: 30, 
                lat: 21.0150, lng: 105.8200, address: "Ngõ 10 Láng Hạ", img: "https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?w=800", host: {phone: "0988777666"},
                costs: { elec: "4k", water: "25k", bike: "100k", service: "200k" },
                amenities: ["Nóng lạnh", "Thang máy", "An ninh", "Máy giặt"]
            },
            {
                id: 3, title: "Phòng trọ Thanh Xuân", price: 2.8, district: "Thanh Xuân", type: "Tro", area: 20, 
                lat: 20.9950, lng: 105.8050, address: "Nguyễn Trãi", img: "https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?w=800", host: {phone: "0911222333"},
                costs: { elec: "3.5k", water: "80k", bike: "50k", service: "Vệ sinh" },
                amenities: ["Chỗ để xe", "Wifi"]
            }
        ];

        const newsList = [
            {title: "Dự báo giá thuê nhà 2025", date: "20/10", img: "https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=600"},
            {title: "Top 5 khu vực đáng sống nhất", date: "18/10", img: "https://images.unsplash.com/photo-1486312338219-ce68d2c6f44d?w=600"}
        ];

        const allAmenities = ["Máy lạnh", "Tủ lạnh", "Gác", "Nóng lạnh", "Thang máy", "An ninh", "Wifi", "Máy giặt"];

        // --- APP CONTROLLER ---
        const app = {
            map: null, circle: null, markers: [],
            priceFilter: 'all',

            init() {
                this.renderRooms(rooms);
                this.renderNews();
                this.initMap();
                
                // Slider
                document.getElementById('radiusRange').addEventListener('input', (e) => {
                    document.getElementById('radiusVal').innerText = e.target.value + " KM";
                });
            },

            nav(view) {
                document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
                document.getElementById('view-'+view).classList.add('active');
                document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
                document.getElementById('l-'+view).classList.add('active');
                window.scrollTo(0,0);
                if(view === 'map') setTimeout(() => this.map.invalidateSize(), 200);
            },

            initMap() {
                this.map = L.map('scanMap').setView([21.0285, 105.8542], 13);
                // Dark Map Layer
                L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', { attribution: '© OpenStreetMap' }).addTo(this.map);
            },

            scanMap() {
                const center = this.map.getCenter();
                const rM = document.getElementById('radiusRange').value * 1000;
                
                if(this.circle) this.map.removeLayer(this.circle);
                this.markers.forEach(m => this.map.removeLayer(m));
                this.markers = [];
                
                this.circle = L.circle(center, { color: '#D4AF37', fillColor: '#D4AF37', fillOpacity: 0.1, radius: rM }).addTo(this.map);
                this.map.fitBounds(this.circle.getBounds());
                
                let found = [];
                const resDiv = document.getElementById('mapResults');
                resDiv.innerHTML = '';
                
                rooms.forEach(r => {
                    if(this.map.distance(center, [r.lat, r.lng]) <= rM) {
                        found.push(r);
                        const m = L.marker([r.lat, r.lng]).addTo(this.map).bindPopup(`<b>${r.title}</b>`);
                        this.markers.push(m);
                        resDiv.innerHTML += `<div class="map-result" onclick="app.showDetail(${r.id})"><img src="${r.img}" class="map-thumb"><div><div style="font-size:13px; color:white;">${r.title}</div><div style="color:var(--gold-primary); font-size:12px;">${r.price} Tr</div></div></div>`;
                    }
                });
            },

            renderRooms(list) {
                const grid = document.getElementById('roomGrid');
                grid.innerHTML = list.map(r => `
                    <div class="card" onclick="app.showDetail(${r.id})" style="cursor:pointer">
                        <div class="room-img-wrap">
                            <span class="room-status">CÒN PHÒNG</span>
                            <img src="${r.img}" class="room-img">
                        </div>
                        <div class="room-body">
                            <h3 class="room-title">${r.title}</h3>
                            <div class="room-addr"><i class="fas fa-map-marker-alt text-gold"></i> ${r.district}</div>
                            <span class="room-price">${r.price} TRIỆU</span>
                        </div>
                    </div>`).join('');
            },

            renderNews() {
                const list = document.getElementById('newsList');
                list.innerHTML = newsList.map(n => `
                    <div class="news-side-item" onclick="alert('Đọc tin')">
                        <img src="${n.img}" class="news-side-img">
                        <div class="news-side-info">
                            <span>${n.date}</span>
                            <h4>${n.title}</h4>
                        </div>
                    </div>
                `).join('');
            },

            showDetail(id) {
                const r = rooms.find(x => x.id === id);
                if(!r) return;

                document.getElementById('dImg').src = r.img;
                document.getElementById('dTitle').innerText = r.title;
                document.getElementById('dPrice').innerText = r.price.toLocaleString('vi-VN') + ",000,000";
                document.getElementById('dAddr').innerText = r.address;

                // Dynamic Cost
                document.getElementById('cElec').innerText = r.costs.elec;
                document.getElementById('cWater').innerText = r.costs.water;
                document.getElementById('cBike').innerText = r.costs.bike;
                document.getElementById('cService').innerText = r.costs.service;

                // Dynamic Amenities Check
                const amList = document.getElementById('amenityList');
                amList.innerHTML = '';
                allAmenities.forEach(am => {
                    const has = r.amenities.includes(am);
                    const icon = has ? '<i class="fas fa-check text-gold"></i>' : '<i class="fas fa-times text-danger"></i>';
                    amList.innerHTML += `<div class="am-item">${icon} ${am}</div>`;
                });

                document.getElementById('dMap').src = `https://maps.google.com/maps?q=${encodeURIComponent(r.address + ", Hà Nội")}&t=&z=15&ie=UTF8&iwloc=&output=embed`;

                const modal = document.getElementById('detailModal');
                modal.style.display = 'flex';
                setTimeout(() => modal.classList.add('open'), 10);
            },
            closeModal() { document.getElementById('detailModal').style.display = 'none'; },
            
            callHost() {
                const title = document.getElementById('dTitle').innerText;
                const r = rooms.find(x => x.title === title);
                if(r) window.open(`tel:${r.host.phone}`);
            },
            
            setPrice(val, btn) {
                this.priceFilter = val;
                document.querySelectorAll('.price-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            },

            search() {
                const dist = document.getElementById('sDist').value;
                const type = document.getElementById('sType').value;
                const price = this.priceFilter;
                
                let res = rooms;
                if(dist !== 'all') res = res.filter(r => r.district === dist);
                if(type !== 'all') res = res.filter(r => r.type === type);
                if(price === 'low') res = res.filter(r => r.price < 3);
                else if(price === 'mid') res = res.filter(r => r.price >= 3 && r.price <= 5);
                else if(price === 'high') res = res.filter(r => r.price > 5);

                this.renderRooms(res);
            }
        };

        const chatbot = {
            toggle() { const w = document.getElementById('chatWindow'); w.style.display = w.style.display === 'flex' ? 'none' : 'flex'; },
            send() {
                const i = document.getElementById('chatInput');
                const t = i.value.trim();
                if(!t) return;
                this.add(t, 'user');
                i.value = '';
                setTimeout(() => this.add("Liên hệ 1900 9999 để được hỗ trợ.", 'bot'), 1000);
            },
            add(txt, type) {
                const d = document.createElement('div');
                d.className = `msg ${type}`;
                d.innerText = txt;
                document.getElementById('chatBody').appendChild(d);
            }
        };
        
        const Auth = {
            open(type) { document.getElementById('authModal').style.display = 'flex'; }
        }

        app.init();
    </script>
</body>
</html>
