<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HanoiStay | Trạm kết nối không gian sống</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;600;700;800&family=Playfair+Display:ital,wght@0,500;0,600;0,700;1,500&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />

    <style>
        /* =========================================
           1. DESIGN SYSTEM (LUXURY GOLD & WEB OPTIMIZED)
           ========================================= */
        :root {
            /* Brand Identity */
            --gold-primary: #C5A028;       /* Vàng Hoàng Gia */
            --gold-hover: #B08D22;
            
            --blue-brand: #0066CC;         /* Xanh App (Chủ đạo nút bấm) */
            --blue-soft: #F0F7FF;

            /* Colors */
            --black-900: #121212;
            --gray-100: #F9FAFB;
            --gray-border: #E5E7EB;
            --white: #FFFFFF;
            
            --text-heading: #111;
            --text-body: #444;
            --text-sub: #666;

            /* Metrics */
            --header-h: 90px;
            --container: 1280px;
            --radius: 12px;
            
            --shadow-card: 0 10px 40px -10px rgba(0,0,0,0.1);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        /* RESET */
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Manrope', sans-serif; scroll-behavior: smooth; }
        body { background-color: var(--gray-100); color: var(--text-body); line-height: 1.6; padding-top: var(--header-h); overflow-x: hidden; }
        h1, h2, h3 { font-family: 'Playfair Display', serif; color: var(--text-heading); }
        a, button { cursor: pointer; text-decoration: none; transition: var(--transition); border: none; outline: none; background: none; }
        img { max-width: 100%; display: block; }
        .container { max-width: var(--container); margin: 0 auto; padding: 0 20px; }
        .hidden { display: none !important; }
        
        /* Utils */
        .text-blue { color: var(--blue-brand); }
        .text-gold { color: var(--gold-primary); }
        .text-center { text-align: center; }

        /* =========================================
           2. UI COMPONENTS
           ========================================= */
        /* Buttons */
        .btn { display: inline-flex; align-items: center; justify-content: center; padding: 12px 28px; border-radius: 50px; font-weight: 700; font-size: 14px; gap: 8px; transition: var(--transition); border: 1px solid transparent; }
        .btn-primary { background: var(--blue-brand); color: white; box-shadow: 0 4px 15px rgba(0, 102, 204, 0.3); }
        .btn-primary:hover { background: #004C99; transform: translateY(-2px); }
        .btn-outline { border-color: var(--blue-brand); color: var(--blue-brand); background: white; }
        .btn-outline:hover { background: var(--blue-soft); }
        .btn-full { width: 100%; }

        /* Cards */
        .card { background: white; border-radius: var(--radius); border: 1px solid var(--gray-border); overflow: hidden; transition: var(--transition); position: relative; }
        .card:hover { transform: translateY(-8px); box-shadow: var(--shadow-card); border-color: var(--gold-primary); }

        /* Badges */
        .badge { padding: 4px 10px; border-radius: 6px; font-size: 11px; font-weight: 800; text-transform: uppercase; display: inline-block; }
        .badge-verified { background: #ECFDF5; color: #059669; border: 1px solid #A7F3D0; }
        .badge-vip { background: linear-gradient(135deg, #EF4444, #B91C1C); color: white; }

        /* View Animation */
        .view-section { display: none; animation: fadeIn 0.6s ease; padding-bottom: 80px; }
        .view-section.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* =========================================
           3. HEADER (MENU 3 PHẦN)
           ========================================= */
        header { position: fixed; top: 0; left: 0; width: 100%; height: var(--header-h); background: rgba(255,255,255,0.98); backdrop-filter: blur(20px); z-index: 1000; border-bottom: 1px solid var(--gray-border); box-shadow: 0 2px 10px rgba(0,0,0,0.03); }
        .nav-inner { height: 100%; display: flex; justify-content: space-between; align-items: center; }
        
        .logo { display: flex; align-items: center; gap: 12px; cursor: pointer; }
        .logo svg { width: 45px; height: 45px; fill: none; stroke: var(--gold-primary); stroke-width: 2.5; }
        .logo-text h1 { font-size: 24px; margin: 0; line-height: 1; letter-spacing: -0.5px; }
        .logo-text p { font-size: 10px; font-weight: 700; color: var(--gold-primary); text-transform: uppercase; letter-spacing: 2px; margin: 0; }

        .nav-menu { display: flex; gap: 40px; }
        .nav-link { font-weight: 700; color: var(--text-sub); font-size: 14px; text-transform: uppercase; position: relative; padding: 10px 0; transition: 0.3s; }
        .nav-link:hover, .nav-link.active { color: var(--gold-primary); }
        .nav-link.active::after { content:''; position: absolute; bottom:0; left:0; width:100%; height:2px; background: var(--gold-primary); }

        /* =========================================
           4. VIEW 1: KHÁM PHÁ (WEB OPTIMIZED SEARCH)
           ========================================= */
        .hero { 
            position: relative; height: 600px; display: flex; align-items: center; justify-content: center; text-align: center;
            background: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.6)), url('https://images.unsplash.com/photo-1545324418-cc1a3fa10c00?w=1600') center/cover;
            margin-bottom: -100px;
        }
        .hero-content { z-index: 2; color: white; margin-bottom: 150px; width: 100%; }
        .hero h1 { font-size: 60px; margin-bottom: 15px; text-shadow: 0 4px 20px rgba(0,0,0,0.4); }
        .hero-slogan { font-size: 22px; font-family: 'Playfair Display'; font-style: italic; color: var(--gold-primary); background: rgba(0,0,0,0.6); padding: 8px 40px; border-radius: 50px; border: 1px solid var(--gold-primary); backdrop-filter: blur(5px); }

        /* --- SEARCH BOX (WEB LAYOUT) --- */
        .search-container { position: absolute; bottom: -200px; width: 100%; padding: 0 20px; z-index: 10; display: flex; justify-content: center; }
        .search-card { 
            background: white; border-radius: 20px; box-shadow: 0 30px 80px rgba(0,0,0,0.15); 
            padding: 40px; width: 100%; max-width: 1100px; border-top: 6px solid var(--blue-brand);
        }
        .search-header { text-align: center; font-weight: 800; font-size: 22px; color: var(--blue-brand); text-transform: uppercase; margin-bottom: 30px; letter-spacing: 1px; border-bottom: 1px solid var(--gray-border); padding-bottom: 15px; }

        /* Row 1: Dropdowns (3 Cột) */
        .search-row-1 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 20px; margin-bottom: 30px; }
        .select-group { position: relative; }
        .select-label { position: absolute; top: -10px; left: 12px; background: var(--blue-brand); color: white; padding: 2px 10px; border-radius: 4px; font-size: 11px; font-weight: 700; }
        .custom-select { width: 100%; padding: 15px; border: 1px solid var(--gray-border); border-radius: 10px; font-size: 15px; font-weight: 600; color: #333; outline: none; background: white; cursor: pointer; }

        /* Row 2: Price (Grid Nút Bấm - Web Friendly) */
        .label-group { font-size: 14px; font-weight: 700; color: #333; margin-bottom: 10px; display: block; }
        .price-grid { display: flex; gap: 10px; margin-bottom: 30px; flex-wrap: wrap; }
        .price-btn { 
            flex: 1; padding: 12px; border: 1px solid var(--gray-border); border-radius: 8px; text-align: center; 
            font-size: 13px; font-weight: 600; cursor: pointer; transition: 0.2s; color: #555; background: white; white-space: nowrap;
        }
        .price-btn:hover, .price-btn.active { border-color: var(--blue-brand); background: var(--blue-soft); color: var(--blue-brand); font-weight: 700; }

        /* Row 3: Amenities (Tags) */
        .amenity-flex { display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 30px; }
        .am-tag { 
            padding: 8px 20px; border: 1px solid var(--gray-border); border-radius: 30px; font-size: 13px; 
            font-weight: 600; cursor: pointer; transition: 0.2s; color: #555; background: white;
        }
        .am-tag:hover, .am-tag.active { border-color: var(--blue-brand); background: var(--blue-soft); color: var(--blue-brand); }

        .btn-search-main { width: 100%; background: var(--blue-brand); color: white; padding: 18px; border-radius: 12px; font-size: 18px; font-weight: 700; box-shadow: 0 4px 15px rgba(0, 102, 204, 0.3); transition: 0.3s; }
        .btn-search-main:hover { background: #004C99; transform: translateY(-2px); }

        /* LISTING */
        .listing-container { padding-top: 250px; padding-bottom: 100px; }
        .section-title { font-size: 36px; margin-bottom: 40px; text-align: center; color: var(--black-900); }
        
        .room-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(360px, 1fr)); gap: 30px; }
        
        .room-img-wrap { height: 260px; position: relative; overflow: hidden; }
        .room-img { width: 100%; height: 100%; object-fit: cover; transition: 0.5s; }
        .card:hover .room-img { transform: scale(1.05); }
        .room-status { position: absolute; bottom: 0; width: 100%; background: var(--blue-brand); color: white; text-align: center; font-size: 12px; padding: 6px; font-weight: 700; }
        
        .room-body { padding: 20px; }
        .room-title { font-size: 18px; font-weight: 700; margin-bottom: 10px; height: 50px; overflow: hidden; line-height: 1.4; }
        .room-price { font-size: 20px; font-weight: 800; color: var(--danger); margin-bottom: 10px; display: block; }
        .room-addr { font-size: 13px; color: var(--text-sub); display: flex; gap: 5px; margin-bottom: 15px; }
        
        /* =========================================
           5. VIEW 2: BẢN ĐỒ (MAP SCANNER)
           ========================================= */
        .map-section { height: 750px; display: grid; grid-template-columns: 350px 1fr; background: white; border-radius: 20px; overflow: hidden; border: 1px solid var(--gray-border); margin-top: 40px; box-shadow: var(--shadow-card); }
        .map-sidebar { padding: 30px; overflow-y: auto; background: white; border-right: 1px solid var(--gray-border); z-index: 2; }
        #scanMap { width: 100%; height: 100%; z-index: 1; }

        .radius-control { background: var(--gray-100); padding: 20px; border-radius: 12px; margin-bottom: 25px; border: 1px solid var(--gray-border); }
        .range-slider { width: 100%; accent-color: var(--blue-brand); height: 6px; margin: 15px 0; cursor: pointer; }
        
        .map-result { display: flex; gap: 15px; padding: 15px; border: 1px solid var(--gray-border); border-radius: 10px; margin-bottom: 10px; cursor: pointer; transition: 0.2s; background: white; }
        .map-result:hover { border-color: var(--blue-brand); box-shadow: var(--shadow-sm); transform: translateX(5px); }
        .map-thumb { width: 70px; height: 70px; border-radius: 8px; object-fit: cover; }
        
        /* Marker Label */
        .price-label { background: var(--blue-brand); color: white; padding: 5px 10px; border-radius: 20px; font-weight: 700; font-size: 12px; border: 2px solid white; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }

        /* =========================================
           6. VIEW 3: TIN TỨC (MAGAZINE STYLE)
           ========================================= */
        .news-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; margin-top: 40px; }
        .news-card { cursor: pointer; }
        .news-card img { width: 100%; height: 240px; object-fit: cover; border-radius: 16px; margin-bottom: 15px; transition: 0.3s; }
        .news-card:hover img { transform: scale(1.02); }
        .news-date { font-size: 12px; font-weight: 700; color: var(--gold-primary); text-transform: uppercase; margin-bottom: 8px; display: block; }
        .news-title { font-size: 20px; font-weight: 700; line-height: 1.4; transition: 0.2s; }
        .news-card:hover .news-title { color: var(--blue-brand); }

        /* Reader Overlay */
        .reader-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; z-index: 3000; transform: translateY(100%); transition: 0.5s cubic-bezier(0.16, 1, 0.3, 1); overflow-y: auto; padding: 60px 20px; }
        .reader-overlay.open { transform: translateY(0); }
        .reader-content { max-width: 800px; margin: 0 auto; }
        .reader-close { position: fixed; top: 30px; right: 30px; font-size: 30px; cursor: pointer; z-index: 3001; }

        /* =========================================
           7. VIEW 4: HỖ TRỢ (SUPPORT)
           ========================================= */
        .support-grid { display: grid; grid-template-columns: 1fr 1.5fr; gap: 60px; margin-top: 60px; }
        .faq-item { background: white; border: 1px solid var(--gray-border); border-radius: 12px; margin-bottom: 15px; overflow: hidden; cursor: pointer; transition: 0.3s; }
        .faq-item:hover { border-color: var(--blue-brand); }
        .faq-head { padding: 20px; font-weight: 700; display: flex; justify-content: space-between; }
        .faq-body { padding: 0 20px 20px; display: none; color: #666; border-top: 1px solid var(--gray-border); padding-top: 15px; }
        .faq-item.active .faq-body { display: block; }

        /* =========================================
           8. VIEW 5: GIỚI THIỆU (ABOUT)
           ========================================= */
        .about-hero { padding: 100px 0; background: var(--black-900); color: white; border-radius: 30px; text-align: center; margin: 40px 0; }
        .mission-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 60px; margin-top: 60px; text-align: left; padding: 0 60px; }
        .ms-card { background: rgba(255,255,255,0.05); padding: 50px; border-left: 5px solid var(--gold-primary); border-radius: 12px; }
        .ms-card h3 { color: var(--gold-primary); font-size: 24px; margin-bottom: 15px; }
        .ms-card p { font-size: 16px; color: #ccc; line-height: 1.8; }

        /* =========================================
           9. MODAL DETAIL (CHÍNH XÁC NHƯ ẢNH P.002)
           ========================================= */
        .modal-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background: rgba(0,0,0,0.8); z-index: 2000; display: none; justify-content: center; align-items: center; opacity: 0; transition: 0.3s; }
        .modal-overlay.open { display: flex; opacity: 1; }
        .modal-content { background: #F2F4F7; width: 100%; max-width: 600px; height: 100%; overflow-y: auto; display: block; padding: 0; position: relative; box-shadow: 0 20px 60px rgba(0,0,0,0.3); }

        /* Header Detail Blue */
        .detail-header-bar { background: var(--blue-brand); color: white; padding: 15px; text-align: center; font-weight: 700; font-size: 18px; position: sticky; top: 0; z-index: 10; display: flex; justify-content: center; align-items: center; }
        .detail-back { position: absolute; left: 15px; cursor: pointer; font-size: 20px; }

        .d-img { width: 100%; height: 350px; object-fit: cover; margin-bottom: 15px; }
        
        /* Cost Table (Grid 4 col) */
        .cost-table { display: grid; grid-template-columns: repeat(4, 1fr); border: 1px solid #ddd; text-align: center; margin: 20px 0; font-size: 12px; background: white; border-radius: 8px; overflow: hidden; }
        .cost-cell { padding: 10px 5px; border-right: 1px solid #ddd; border-bottom: 1px solid #ddd; }
        .cost-val { color: var(--blue-brand); font-weight: 700; font-size: 15px; display: block; margin: 4px 0; }
        
        /* Check List */
        .check-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; margin: 20px 0; font-size: 14px; color: #333; }
        .check-item { display: flex; align-items: center; gap: 5px; }
        .fa-check { color: var(--blue-brand); }
        .fa-times { color: var(--danger); }

        /* Sticky Footer */
        .detail-footer { position: fixed; bottom: 0; left: 50%; transform: translateX(-50%); width: 100%; max-width: 600px; background: white; padding: 15px 20px; border-top: 1px solid #ddd; display: grid; grid-template-columns: 2fr 1fr 1fr; gap: 10px; box-shadow: 0 -5px 20px rgba(0,0,0,0.1); z-index: 20; }
        .action-icon { display: flex; flex-direction: column; align-items: center; justify-content: center; font-size: 11px; color: #666; cursor: pointer; }
        .action-icon i { font-size: 22px; margin-bottom: 4px; color: var(--blue-brand); }

        /* =========================================
           10. CHATBOT
           ========================================= */
        .chat-btn { position: fixed; bottom: 30px; right: 30px; width: 65px; height: 65px; background: var(--blue-brand); color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 28px; cursor: pointer; z-index: 9000; box-shadow: 0 10px 30px rgba(0, 102, 204, 0.4); }
        .chat-window { position: fixed; bottom: 100px; right: 30px; width: 350px; height: 500px; background: white; border-radius: 16px; box-shadow: 0 20px 60px rgba(0,0,0,0.2); z-index: 9000; display: none; flex-direction: column; overflow: hidden; border: 1px solid #ddd; }
        .chat-header { background: var(--blue-brand); color: white; padding: 15px; display: flex; justify-content: space-between; align-items: center; font-weight: 700; }
        .chat-body { flex: 1; padding: 15px; overflow-y: auto; background: #F5F5F5; }
        .msg { padding: 10px 14px; border-radius: 12px; margin-bottom: 10px; font-size: 13px; max-width: 85%; }
        .msg.bot { background: white; border: 1px solid #ddd; align-self: flex-start; }
        .msg.user { background: var(--blue-brand); color: white; align-self: flex-end; }
        .chat-footer { padding: 10px; border-top: 1px solid #ddd; display: flex; background: white; }

        /* Footer */
        footer { background: var(--black-900); color: #999; padding: 80px 0 30px; margin-top: 100px; }
        .footer-grid { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr; gap: 40px; }

        @media (max-width: 1024px) {
            .search-row-1 { grid-template-columns: 1fr; }
            .map-section { grid-template-columns: 1fr; height: auto; }
            #scanMap { height: 400px; }
            .footer-grid, .about-grid, .support-grid, .news-grid { grid-template-columns: 1fr; }
            .nav-menu { display: none; }
        }
    </style>
</head>
<body>

    <header>
        <div class="container nav-inner">
            <div class="logo" onclick="app.nav('home')">
                <svg width="45" height="45" viewBox="0 0 100 100" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M50 10L15 40V90H85V40L50 10Z" stroke="#D4AF37" stroke-width="4" stroke-linejoin="round"/>
                    <path d="M50 35L30 55C30 55 40 75 50 75C60 75 70 55 70 55L50 35Z" stroke="#D4AF37" stroke-width="4"/>
                    <rect x="42" y="48" width="16" height="16" rx="2" stroke="#D4AF37" stroke-width="3"/>
                </svg>
                <div style="margin-left:10px;">
                    <h1 style="font-size:24px; margin:0; line-height:1; color:var(--text-heading);">HANOISTAY</h1>
                    <p style="font-size:10px; font-weight:700; color:var(--gold-primary); letter-spacing:1px; margin:0;">TRẠM KẾT NỐI KHÔNG GIAN SỐNG</p>
                </div>
            </div>
            
            <ul class="nav-menu">
                <li><a onclick="app.nav('home')" class="nav-link active" id="l-home">Khám Phá</a></li>
                <li><a onclick="app.nav('map')" class="nav-link" id="l-map">Bản Đồ</a></li>
                <li><a onclick="app.nav('about')" class="nav-link" id="l-about">Giới Thiệu</a></li>
            </ul>
        </div>
    </header>

    <main id="view-home" class="view-section active" style="padding-top:0;">
        <section class="hero">
            <div class="hero-content">
                <h1 style="font-size:64px; margin-bottom:20px; color:white; text-shadow:0 5px 15px rgba(0,0,0,0.3);">Tìm trọ thông minh<br>An cư lạc nghiệp</h1>
                <p class="hero-slogan" style="font-size:24px; font-family:'Playfair Display'; font-style:italic; color:var(--gold-primary); background:rgba(0,0,0,0.6); padding:8px 30px; border-radius:50px; display:inline-block; backdrop-filter:blur(5px);">Trạm kết nối không gian sống</p>
                
                <div class="search-container">
                    <div class="search-card">
                        <div style="text-align:center; color:var(--blue-brand); font-weight:800; font-size:20px; margin-bottom:25px; border-bottom:2px solid #f0f0f0; padding-bottom:15px; text-transform:uppercase;">LỌC TÌM PHÒNG</div>
                        
                        <div class="search-row-1">
                            <div style="position:relative"><label class="select-label">Tỉnh/Thành phố</label><select class="custom-select"><option>Thành phố Hà Nội</option></select></div>
                            <div style="position:relative"><label class="select-label">Quận/Huyện</label><select id="sDist" class="custom-select"><option value="all">Tất cả quận</option><option value="Cầu Giấy">Cầu Giấy</option><option value="Đống Đa">Đống Đa</option><option value="Thanh Xuân">Thanh Xuân</option></select></div>
                            <div style="position:relative"><label class="select-label">Loại phòng</label><select id="sType" class="custom-select"><option value="all">Tất cả loại</option><option value="Tro">Phòng trọ</option><option value="Mini">Chung cư Mini</option><option value="Studio">Studio</option></select></div>
                        </div>

                        <div style="margin-bottom:25px;">
                            <label style="font-size:14px; font-weight:700; color:#333; margin-bottom:10px; display:block;">Giá <span class="text-danger">(chọn khoảng giá)</span></label>
                            <div class="price-grid">
                                <div class="price-btn active" onclick="app.setPrice('all', this)">Tất cả</div>
                                <div class="price-btn" onclick="app.setPrice('low', this)"><= 2 triệu</div>
                                <div class="price-btn" onclick="app.setPrice('mid', this)">3 - 5 triệu</div>
                                <div class="price-btn" onclick="app.setPrice('high', this)">5 - 8 triệu</div>
                                <div class="price-btn" onclick="app.setPrice('vip', this)">8 - 10 triệu</div>
                                <div class="price-btn" onclick="app.setPrice('max', this)">> 10 triệu</div>
                            </div>
                        </div>

                        <div style="margin-bottom:30px;">
                            <label style="font-size:14px; font-weight:700; color:#333; margin-bottom:10px; display:block;">Tiện ích khác <span class="text-danger">(chọn thêm)</span></label>
                            <div class="amenity-tags">
                                <div class="am-tag" onclick="this.classList.toggle('active')">Có máy lạnh</div>
                                <div class="am-tag" onclick="this.classList.toggle('active')">Có gác</div>
                                <div class="am-tag" onclick="this.classList.toggle('active')">Có tủ lạnh</div>
                                <div class="am-tag" onclick="this.classList.toggle('active')">An ninh</div>
                            </div>
                        </div>

                        <button class="btn btn-primary btn-full" style="height:50px; font-size:16px;" onclick="app.search()">ÁP DỤNG TÌM KIẾM</button>
                    </div>
                </div>
            </div>
        </section>

        <section class="container" style="padding-top:220px; padding-bottom:100px;">
            <div style="display:flex; justify-content:space-between; align-items:end; margin-bottom:40px;">
                <h2 style="font-size:36px; margin:0; color:var(--text-heading)">Phòng nổi bật</h2>
                <button class="btn btn-outline" onclick="app.nav('map')">Xem Bản Đồ <i class="fas fa-arrow-right"></i></button>
            </div>
            
            <div class="grid" id="roomGrid" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(350px,1fr)); gap:30px;">
                </div>
        </section>
    </main>

    <main id="view-map" class="view-section container">
        <h2 style="margin:40px 0; font-size:36px;">Quét Bản Đồ</h2>
        <div style="display:grid; grid-template-columns:350px 1fr; height:750px; background:white; border-radius:20px; overflow:hidden; border:1px solid var(--gray-200); box-shadow:var(--shadow-card);">
            <div style="padding:30px; overflow-y:auto; border-right:1px solid var(--gray-200); background:white; z-index:2;">
                <h3 style="font-size:18px; color:var(--text-sub); margin-bottom:20px;">QUÉT BÁN KÍNH</h3>
                <div style="background:var(--gray-100); padding:20px; border-radius:12px; margin-bottom:20px;">
                    <div style="display:flex; justify-content:space-between; margin-bottom:10px; font-weight:700;">
                        <span>Bán kính</span> <span id="radiusVal" style="color:var(--blue-brand)">2 km</span>
                    </div>
                    <input type="range" id="radiusRange" min="1" max="10" value="2" step="0.5" style="width:100%; accent-color:var(--blue-brand); cursor:pointer;">
                    <button class="btn btn-primary btn-full" style="margin-top:15px;" onclick="app.scanMap()">QUÉT NGAY</button>
                </div>
                <div style="margin-top:30px;">
                    <h4 style="font-size:12px; color:var(--text-light); text-transform:uppercase; margin-bottom:15px;">KẾT QUẢ (<span id="foundCount">0</span>)</h4>
                    <div id="mapResults"></div>
                </div>
            </div>
            <div id="scanMap" style="width:100%; height:100%; z-index:1;"></div>
        </div>
    </main>

    <main id="view-news" class="view-section container">
        <h2 style="margin:40px 0; text-align:center; font-size:36px;">Cẩm nang & Tin tức</h2>
        <div id="newsGrid" style="display:grid; grid-template-columns:repeat(3,1fr); gap:30px;"></div>
    </main>
    <div id="newsReader" style="position:fixed; top:0; right:-100%; width:100%; max-width:900px; height:100%; background:white; z-index:3000; transition:0.4s; box-shadow:-20px 0 50px rgba(0,0,0,0.2); overflow-y:auto; padding:60px;">
        <button onclick="document.getElementById('newsReader').style.right='-100%'" style="position:absolute; top:30px; right:30px; font-size:30px; border:none; background:none; cursor:pointer;">×</button>
        <div id="newsContent"></div>
    </div>

    <main id="view-support" class="view-section container">
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:60px; margin-top:60px;">
            <div>
                <h2 style="margin-bottom:30px;">Câu hỏi thường gặp</h2>
                <div class="card" style="padding:20px; margin-bottom:15px; cursor:pointer;" onclick="this.classList.toggle('active')">
                    <div style="font-weight:700; display:flex; justify-content:space-between;">Quy định đăng tin? <i class="fas fa-chevron-down"></i></div>
                    <div class="hidden" style="margin-top:10px; color:var(--text-sub); display:none;">Thông tin chính xác 100%.</div>
                </div>
            </div>
            <div class="card" style="padding:40px;">
                <h3 style="margin-bottom:20px;">Gửi yêu cầu</h3>
                <input class="form-control" placeholder="Email..." style="margin-bottom:15px;">
                <textarea class="form-control" rows="4" placeholder="Nội dung..."></textarea>
                <button class="btn btn-primary btn-full" style="margin-top:20px;">Gửi yêu cầu</button>
            </div>
        </div>
    </main>

    <main id="view-about" class="view-section container" style="margin-top:60px;">
        <div style="text-align:center; margin-bottom:80px;">
            <span class="badge badge-verified" style="margin:0 auto 20px;">CÂU CHUYỆN THƯƠNG HIỆU</span>
            <h1 style="font-size:48px; margin-bottom:20px;">Sứ mệnh & Tầm nhìn</h1>
            <p style="font-size:18px; color:var(--text-sub); max-width:800px; margin:0 auto;">HanoiStay cam kết minh bạch hóa thị trường thuê trọ với công nghệ tiên tiến.</p>
        </div>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:60px;">
            <div style="padding:40px; background:white; border-radius:20px; border-left:5px solid var(--gold-primary); box-shadow:var(--shadow-card);">
                <i class="fas fa-rocket" style="font-size:40px; color:var(--gold-primary); margin-bottom:20px;"></i>
                <h3 style="margin-bottom:15px;">Sứ Mệnh</h3>
                <p style="color:var(--text-sub)">Mang lại trải nghiệm tìm nhà an toàn, nhanh chóng và minh bạch cho người Việt trẻ.</p>
            </div>
            <div style="padding:40px; background:white; border-radius:20px; border-left:5px solid var(--blue-brand); box-shadow:var(--shadow-card);">
                <i class="fas fa-eye" style="font-size:40px; color:var(--blue-brand); margin-bottom:20px;"></i>
                <h3 style="margin-bottom:15px;">Tầm Nhìn 2030</h3>
                <p style="color:var(--text-sub)">Trở thành hệ sinh thái PropTech (Công nghệ Bất động sản) số 1 Đông Nam Á.</p>
            </div>
        </div>
    </main>

    <div class="modal-overlay" id="detailModal">
        <div class="modal-content">
            <div style="background:var(--blue-brand); color:white; padding:15px; text-align:center; font-weight:700; font-size:18px; position:sticky; top:0; z-index:10; display:flex; justify-content:center; align-items:center;">
                <span onclick="app.closeModal()" style="position:absolute; left:15px; cursor:pointer;"><i class="fas fa-arrow-left"></i></span>
                <span id="dCode">P.002</span>
            </div>

            <div style="padding:15px; background:white; padding-bottom:100px;">
                <img id="dImg" style="width:100%; height:300px; object-fit:cover; margin-bottom:15px;">
                
                <h1 id="dTitle" style="font-size:18px; font-weight:700; margin:0; line-height:1.4;"></h1>
                <p id="dPrice" style="color:red; font-weight:700; font-size:20px; margin:10px 0;"></p>
                <p id="dAddr" style="font-size:14px; color:#333; margin-bottom:10px;"><i class="fas fa-map-marker-alt text-blue"></i> <span></span></p>
                <p style="font-size:14px; color:#333;"><i class="far fa-clock"></i> Tự do</p>

                <h3 style="font-size:18px; font-weight:700; margin:20px 0 10px;">Chi phí dự kiến</h3>
                <div style="display:grid; grid-template-columns:repeat(4, 1fr); border:1px solid #ddd; text-align:center; font-size:13px;">
                    <div style="padding:10px; border-right:1px solid #ddd;">Điện<br><span id="cElec" style="color:var(--blue-brand); font-weight:700;"></span></div>
                    <div style="padding:10px; border-right:1px solid #ddd;">Nước<br><span id="cWater" style="color:var(--blue-brand); font-weight:700;"></span></div>
                    <div style="padding:10px; border-right:1px solid #ddd;">Xe<br><span id="cBike" style="color:var(--blue-brand); font-weight:700;"></span></div>
                    <div style="padding:10px;">Quản lý<br><span id="cService" style="color:var(--blue-brand); font-weight:700;"></span></div>
                </div>
                
                <h3 style="font-size:18px; font-weight:700; margin:20px 0 10px;">Thông tin chi tiết</h3>
                <div style="font-size:14px; color:#333; line-height:1.8;">
                    <div style="display:flex; justify-content:space-between;"><span>Vị trí: <span style="color:var(--blue-brand)">Trệt</span></span> <span>Số người ở: 2</span></div>
                    <div style="display:flex; justify-content:space-between;"><span>Nhà xe: <span style="color:var(--blue-brand)">Chung</span></span> <span>Diện tích: <span id="dAreaDetail">20m2</span></span></div>
                    <hr style="border:0; border-top:1px solid #eee; margin:10px 0;">
                    
                    <div id="amenityList" style="display:grid; grid-template-columns:1fr 1fr 1fr; gap:10px;"></div>
                </div>

                <h3 style="font-size:18px; font-weight:700; margin:20px 0 10px;">Vị trí bản đồ</h3>
                <iframe id="dMap" width="100%" height="250" style="border:0; border-radius:8px;" loading="lazy"></iframe>
            </div>

            <div style="position:fixed; bottom:0; left:50%; transform:translateX(-50%); width:100%; max-width:600px; background:white; padding:15px; border-top:1px solid #ddd; display:grid; grid-template-columns:2fr 1fr 1fr; gap:10px; box-shadow:0 -5px 20px rgba(0,0,0,0.1); z-index:20;">
                <button class="btn btn-primary btn-full" style="background:var(--blue-brand); border-radius:30px;">Đặt lịch xem phòng</button>
                <div style="display:flex; flex-direction:column; align-items:center; justify-content:center; font-size:11px; color:#666; cursor:pointer;"><i class="far fa-comment-dots" style="font-size:20px; color:var(--blue-brand);"></i> Chat</div>
                <div style="display:flex; flex-direction:column; align-items:center; justify-content:center; font-size:11px; color:#666; cursor:pointer;" onclick="app.callHost()"><i class="fas fa-phone-alt" style="font-size:20px; color:var(--blue-brand);"></i> Gọi</div>
            </div>
        </div>
    </div>

    <div class="chat-btn" onclick="chatbot.toggle()" style="position:fixed; bottom:30px; right:30px; width:60px; height:60px; background:var(--blue-brand); color:white; border-radius:50%; display:flex; align-items:center; justify-content:center; font-size:28px; cursor:pointer; z-index:9000; box-shadow:0 10px 20px rgba(0,0,0,0.2);"><i class="fas fa-comment-dots"></i></div>
    <div class="chat-window" id="chatWindow" style="position:fixed; bottom:100px; right:30px; width:350px; height:500px; background:white; border-radius:16px; box-shadow:0 20px 50px rgba(0,0,0,0.2); z-index:9000; display:none; flex-direction:column; border:1px solid #ddd;">
        <div style="padding:15px; background:var(--blue-brand); color:white; font-weight:700; display:flex; justify-content:space-between; align-items:center;">
            <span>Trợ lý HanoiStay</span> <span onclick="chatbot.toggle()" style="cursor:pointer">×</span>
        </div>
        <div id="chatBody" style="flex:1; padding:15px; overflow-y:auto; background:#f9f9f9;">
            <div style="background:white; padding:10px; border-radius:10px; width:80%; margin-bottom:10px; border:1px solid #eee; font-size:14px;">Xin chào! Bạn cần tìm phòng khu vực nào?</div>
        </div>
        <div style="padding:10px; border-top:1px solid #eee; display:flex;">
            <input id="chatInput" style="flex:1; border:none; outline:none; background:transparent;" placeholder="Nhập tin nhắn...">
            <button onclick="chatbot.send()" style="color:var(--blue-brand)"><i class="fas fa-paper-plane"></i></button>
        </div>
    </div>

    <footer style="background:var(--black-900); color:#999; padding:80px 0 30px; margin-top:100px;">
        <div class="container" style="display:grid; grid-template-columns:2fr 1fr 1fr 1fr; gap:40px;">
            <div><h2 style="color:white; margin-bottom:20px;">HANOISTAY</h2><p>Trạm kết nối không gian sống.</p></div>
            <div><h4 style="color:white; margin-bottom:20px;">Khám phá</h4><ul><li>Phòng trọ</li><li>Căn hộ</li></ul></div>
            <div><h4 style="color:white; margin-bottom:20px;">Hỗ trợ</h4><ul><li>Bảng giá</li><li>Quy định</li></ul></div>
            <div><h4 style="color:white; margin-bottom:20px;">Liên hệ</h4><ul><li>1900 8888</li><li>vip@hanoistay.vn</li></ul></div>
        </div>
    </footer>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // DATA
        const rooms = [
            {id:1, title:"Phòng thường - Trệt - Không máy lạnh", price:3.2, district:"Nhà Bè", type:"Tro", area:20, lat:21.0350, lng:105.7950, address:"Mặt tiền Đường Số 8, Kdc Lập Phúc, Nhà Bè", img:"https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=800", host:{phone:"0912345678"}, costs: {elec:"3.8k", water:"25k", bike:"Free", service:"50k"}, amenities: ["Gác", "Cửa sổ"]},
            {id:2, title:"Chung cư Mini Đống Đa Full đồ", price:4.8, district:"Đống Đa", type:"Mini", area:25, lat:21.0150, lng:105.8200, address:"Ngõ 10 Láng Hạ", img:"https://images.unsplash.com/photo-1502672260266-1c1ef2d93688?w=800", host:{phone:"0988777666"}, costs: {elec:"4k", water:"100k", bike:"100k", service:"150k"}, amenities: ["Máy lạnh", "Tủ lạnh", "Thang máy"]},
            {id:3, title:"Studio Cầu Giấy Ban Công", price:5.0, district:"Cầu Giấy", type:"Studio", area:35, lat:21.0300, lng:105.7800, address:"Quan Hoa, Cầu Giấy", img:"https://images.unsplash.com/photo-1554995207-c18c203602cb?w=800", host:{phone:"0909000999"}, costs: {elec:"3.8k", water:"100k", bike:"Free", service:"100k"}, amenities: ["Máy lạnh", "Gác", "Kệ bếp"]},
            {id:4, title:"Phòng trọ Thanh Xuân", price:3.0, district:"Thanh Xuân", type:"Tro", area:18, lat:20.9950, lng:105.8050, address:"Nguyễn Trãi, Thanh Xuân", img:"https://images.unsplash.com/photo-1596230529625-7ee541fb33f6?w=800", host:{phone:"0911222333"}, costs: {elec:"4k", water:"80k", bike:"50k", service:"50k"}, amenities: ["Wifi", "Chỗ để xe"]}
        ];

        const news = [
            {id:1, title:"Kinh nghiệm thuê phòng 2024", date:"20/10", img:"https://images.unsplash.com/photo-1486312338219-ce68d2c6f44d?w=600", content:"Nội dung bài viết..."},
            {id:2, title:"Dự báo giá thuê nhà Hà Nội", date:"18/10", img:"https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=600", content:"Phân tích thị trường..."}
        ];

        const allAmenities = ["Gác", "Cửa sổ", "Ban công", "Tủ lạnh", "Máy lạnh", "Máy giặt", "Nóng lạnh", "Thang máy", "An ninh"];

        const app = {
            map: null, circle: null, markers: [],
            priceFilter: 'all',

            init() {
                this.renderRooms(rooms);
                this.renderNews(news);
                this.initMap();
                document.getElementById('radiusRange').addEventListener('input', (e) => {
                    document.getElementById('radiusVal').innerText = e.target.value + " KM";
                });
            },

            nav(view) {
                document.querySelectorAll('.view-section').forEach(el => el.classList.add('hidden'));
                document.getElementById('view-'+view).classList.remove('hidden');
                document.getElementById('view-'+view).classList.add('active');
                
                document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active'));
                document.getElementById('l-'+view).classList.add('active');
                
                window.scrollTo(0,0);
                if(view === 'map') setTimeout(() => this.map.invalidateSize(), 200);
            },

            // MAP SCANNER (POSITRON LIGHT)
            initMap() {
                this.map = L.map('scanMap').setView([21.0285, 105.8542], 13);
                L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', { attribution: '© OpenStreetMap' }).addTo(this.map);
            },
            scanMap() {
                const center = this.map.getCenter();
                const rM = document.getElementById('radiusRange').value * 1000;

                if(this.circle) this.map.removeLayer(this.circle);
                this.markers.forEach(m => this.map.removeLayer(m));
                this.markers = [];

                this.circle = L.circle(center, { color: '#0066CC', fillColor: '#0066CC', fillOpacity: 0.1, radius: rM }).addTo(this.map);
                this.map.fitBounds(this.circle.getBounds());

                let found = [];
                const resDiv = document.getElementById('mapResults');
                resDiv.innerHTML = '';

                rooms.forEach(r => {
                    if(this.map.distance(center, [r.lat, r.lng]) <= rM) {
                        found.push(r);
                        const m = L.marker([r.lat, r.lng]).addTo(this.map).bindPopup(`<b>${r.title}</b>`);
                        this.markers.push(m);
                        resDiv.innerHTML += `<div style="padding:10px; border:1px solid #eee; margin-bottom:10px; cursor:pointer; background:white; display:flex; gap:10px;" onclick="app.showDetail(${r.id})"><img src="${r.img}" style="width:50px; height:50px; object-fit:cover;"><div><div style="font-weight:700; font-size:13px;">${r.title}</div><div style="color:blue;">${r.price} Tr</div></div></div>`;
                    }
                });
                document.getElementById('foundCount').innerText = found.length;
            },

            // RENDER & SEARCH
            renderRooms(list) {
                const grid = document.getElementById('roomGrid');
                grid.innerHTML = list.length ? list.map(r => `
                    <div class="card" onclick="app.showDetail(${r.id})" style="cursor:pointer">
                        <div class="room-img-wrap" style="height:250px; position:relative; overflow:hidden;">
                            <div class="room-status" style="position:absolute; bottom:0; width:100%; background:#0066CC; color:white; text-align:center; font-weight:700; font-size:14px; padding:8px;">Còn phòng trống</div>
                            <img src="${r.img}" style="width:100%; height:100%; object-fit:cover; transition:0.5s;" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">
                        </div>
                        <div style="padding:15px;">
                            <h3 style="font-size:16px; margin:0 0 5px; height:45px; overflow:hidden;">${r.title}</h3>
                            <div style="font-size:14px; color:#666; margin-bottom:10px;">${r.address}</div>
                            <div style="font-size:18px; font-weight:700; color:#0066CC;">Giá: ${r.price} triệu</div>
                            <div style="font-size:13px; color:#999;">Tổng: 1 phòng</div>
                        </div>
                    </div>`).join('') : '<p class="text-center" style="grid-column:1/-1; padding:50px;">Không tìm thấy phòng phù hợp.</p>';
            },

            setPrice(val, btn) {
                this.priceFilter = val;
                document.querySelectorAll('.price-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
            },

            search() {
                const dist = document.getElementById('sDist').value;
                const type = document.getElementById('sType').value;
                const price = this.priceFilter;
                
                let res = rooms;
                if(dist !== 'all') res = res.filter(r => r.district === dist);
                if(type !== 'all') res = res.filter(r => r.type === type);
                if(price === 'low') res = res.filter(r => r.price < 3);
                else if(price === 'mid') res = res.filter(r => r.price >= 3 && r.price <= 5);
                else if(price === 'high') res = res.filter(r => r.price > 5);
                
                this.renderRooms(res);
            },
            
            renderNews(list) {
                document.getElementById('newsGrid').innerHTML = list.map(n => `<div class="card" style="padding:20px;" onclick="app.readNews('${n.title}', '${n.content}', '${n.img}')"><img src="${n.img}" style="width:100%; height:200px; object-fit:cover; margin-bottom:15px;"><h3 style="font-size:18px;">${n.title}</h3><p style="color:#888; font-size:13px;">${n.date}</p></div>`).join('');
            },

            readNews(t, c, i) {
                document.getElementById('newsContent').innerHTML = `<h1>${t}</h1><img src="${i}" style="width:100%; border-radius:12px; margin:20px 0;"><p>${c}</p>`;
                document.getElementById('newsReader').style.right = '0';
            },

            showDetail(id) {
                const r = rooms.find(x => x.id === id);
                document.getElementById('dImg').src = r.img;
                document.getElementById('dTitle').innerText = r.title;
                document.getElementById('dAddr').querySelector('span').innerText = r.address;
                document.getElementById('dPrice').innerText = r.price.toLocaleString('vi-VN') + ",000,000";
                document.getElementById('dAreaDetail').innerText = r.area + "m2";
                
                // Populate Costs
                document.getElementById('cElec').innerText = r.costs.elec;
                document.getElementById('cWater').innerText = r.costs.water;
                document.getElementById('cBike').innerText = r.costs.bike;
                document.getElementById('cService').innerText = r.costs.service;

                // Populate Amenities with Check/Cross
                const amList = document.getElementById('amenityList');
                amList.innerHTML = '';
                allAmenities.forEach(am => {
                    const has = r.amenities.includes(am);
                    const icon = has ? '<i class="fas fa-check text-blue"></i>' : '<i class="fas fa-times text-danger"></i>';
                    amList.innerHTML += `<div class="check-item" style="display:flex; justify-content:space-between;"><span>${am}:</span> ${icon}</div>`;
                });

                // Google Map
                document.getElementById('dMap').src = `https://maps.google.com/maps?q=${encodeURIComponent(r.address + ", Hà Nội")}&t=&z=15&ie=UTF8&iwloc=&output=embed`;
                
                document.getElementById('detailModal').style.display = 'flex';
            },
            closeModal() { document.getElementById('detailModal').style.display = 'none'; },
            
            callHost() {
                const r = rooms.find(x => x.title === document.getElementById('dTitle').innerText);
                if(r) window.open(`tel:${r.host.phone}`);
            }
        };

        const chatbot = {
            toggle() { const w = document.getElementById('chatWindow'); w.style.display = w.style.display === 'flex' ? 'none' : 'flex'; },
            send() {
                const i = document.getElementById('chatInput');
                const t = i.value.trim();
                if(!t) return;
                this.add(t, 'user');
                i.value = '';
                setTimeout(() => {
                    let r = "Xin lỗi, mình chưa hiểu. Liên hệ 1900 9999.";
                    if(t.toLowerCase().includes('giá')) r = "Giá từ 3 - 10 triệu ạ.";
                    this.add(r, 'bot');
                }, 1000);
            },
            add(txt, type) {
                const d = document.createElement('div');
                d.className = `msg ${type}`;
                d.innerText = txt;
                document.getElementById('chatBody').appendChild(d);
                document.getElementById('chatBody').scrollTop = document.getElementById('chatBody').scrollHeight;
            }
        };

        app.init();
    </script>
</body>
</html>
